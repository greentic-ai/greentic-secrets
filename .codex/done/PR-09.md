# PR-09.md (greentic-secrets)
# Title: Secrets providers as provider-core packs (end-to-end complete)

## Goal
Convert secrets providers to provider-core + schemas + provider extension.

## Deliverables per provider
For each of:
- aws-sm
- azure-kv
- gcp-sm
- vault-kv
- k8s

Provide:
- `schemas/secrets/<provider>/config.schema.json`
- optional `schemas/secrets/<provider>/state.schema.json`
- provider-core runtime component implementing:
  - ops: `get`, `put`, `delete` (optionally `list`)
- pack manifest extension entry declaring provider metadata

## Tasks
1. **Schemas**
   - Define config schemas with required fields:
     - provider endpoint/region/tenant, credentials reference style (NOT raw secrets unless explicitly supported)
     - add `x-secret: true` to secret fields if they must be entered
2. **Runtime component**
   - Implement provider-core world in wasm component(s)
   - Use `invoke(op, input_json)`:
     - `get`: input `{ "key": "..." }`
     - `put`: input `{ "key": "...", "value": "<base64 or bytes-as-json>" }`
     - `delete`: input `{ "key": "..." }`
3. **Pack extension**
   - Add inline `greentic.ext.provider` with `runtime.world` pinned to provider-core v1
4. **Tests**
   - Pack validation tests: extension + schema present
   - Runner integration test using a dummy/in-memory secrets provider pack (can be in greentic-integration too)

## Acceptance criteria
- Deployer can onboard each secrets provider pack using schema prompts + validate-config.
- Runner can call `put/get/delete` via provider-core.
- No dependency on legacy secrets provider protocol WIT.
